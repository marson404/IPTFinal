import{a as $}from"./chunk-Q3S7IUFL.js";import{a as Y}from"./chunk-FNBHHN2H.js";import{a as Z}from"./chunk-JJSI5YBX.js";import{a as N,b as z,c as R,d as j,e as B,f as L,h as Q,i as U,j as H,l as G,o as J}from"./chunk-SWDTLJ4O.js";import{a as K}from"./chunk-ZAOS4JY5.js";import{a as X}from"./chunk-EIQSXQVF.js";import{A as u,B as O,F as s,I as p,J as C,K as i,L as t,N as A,O as E,P as M,Q as k,R as I,S as D,T as v,U as d,V as F,W as w,Y as _,Z as h,_ as S,h as x,j as P,ka as T,la as V,na as q,s as f,t as g,ta as W,y as m}from"./chunk-RY5F4FTU.js";var te=["employeeForm"];function ie(a,l){if(a&1&&(i(0,"div",31),d(1),t()),a&2){let n=M();m(),w(" ",n.error," ")}}function oe(a,l){if(a&1&&(i(0,"option",32),d(1),t()),a&2){let n=l.$implicit;p("value",n.email),m(),w(" ",n.email," ")}}function ne(a,l){a&1&&(i(0,"div"),d(1,"Email is required."),t())}function re(a,l){if(a&1&&(i(0,"div",33),s(1,ne,2,0,"div",34),t()),a&2){M();let n=v(12);m(),p("ngIf",n.errors==null?null:n.errors.required)}}function ae(a,l){a&1&&(i(0,"div",35),d(1," Position is required "),t())}function le(a,l){if(a&1&&(i(0,"option",32),d(1),t()),a&2){let n=l.$implicit;p("value",n.name),m(),F(n.name)}}function de(a,l){a&1&&(i(0,"div",35),d(1," Department is required "),t())}function me(a,l){a&1&&(i(0,"div",35),d(1," Hire Date is required "),t())}function ce(a,l){a&1&&(i(0,"div",35),d(1," Status is required "),t())}var ee=class a{constructor(l,n,e,r,c,o){this.employeeService=l;this.departmentService=n;this.workflowService=e;this.accountService=r;this.router=c;this.requestService=o}employeeForm;formSubmitted=!1;departments=[];activeAccountEmails=[];error="";isSubmitting=!1;employee={id:0,email:"",position:"",department:"",hire_date:new Date().toISOString().split("T")[0],status:"Active"};ngOnInit(){x({departments:this.departmentService.getAll(),users:this.accountService.getAllActiveUsers()}).subscribe({next:l=>{this.departments=l.departments,this.activeAccountEmails=l.users.map(n=>({id:n.id,email:n.email}))},error:l=>{this.error="Error loading data: "+l}})}onSubmit(){if(!this.isSubmitting)if(this.isSubmitting=!0,this.formSubmitted=!0,this.error="",this.employeeForm.form.valid){let l=this.activeAccountEmails.find(r=>r.email===this.employee.email),n=this.departments.find(r=>r.name===this.employee.department);if(!l||!n){this.error=l?"Selected department not found":"Selected email not found",this.isSubmitting=!1;return}let e={user_id:l.id,department_id:n.id,position:this.employee.position,hire_date:this.employee.hire_date,status:this.employee.status};this.employeeService.createEmployee(e).pipe(P(()=>this.isSubmitting=!1)).subscribe({next:r=>{console.log("Employee created:",r),this.navigateToEmployees()},error:r=>{console.error("Employee creation failed:",r),this.error="Error creating employee: "+(r.error?.message||r.message),this.isSubmitting=!1}})}else this.isSubmitting=!1,this.error="Please fill in all required fields correctly."}navigateToEmployees(){this.router.navigate(["/employees"]).then(()=>console.log("Navigation successful")).catch(()=>window.location.href="/employees")}cancel(){this.navigateToEmployees()}static \u0275fac=function(n){return new(n||a)(u(Y),u(X),u($),u(K),u(W),u(Z))};static \u0275cmp=O({type:a,selectors:[["app-add-employee"]],viewQuery:function(n,e){if(n&1&&k(te,5),n&2){let r;I(r=D())&&(e.employeeForm=r.first)}},decls:57,vars:21,consts:[["employeeForm","ngForm"],["email","ngModel"],["positionField","ngModel"],["departmentField","ngModel"],["hireDateField","ngModel"],["statusField","ngModel"],[1,"card"],[1,"card-header"],["class","alert alert-danger mx-3 mt-3",4,"ngIf"],[1,"form",3,"ngSubmit"],[1,"form-row"],[1,"form-group"],["for","email"],["id","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","alert alert-danger",4,"ngIf"],["for","position"],["id","position","name","position","type","text","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","invalid-feedback",4,"ngIf"],["for","department"],["id","department","name","department","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","hireDate"],["id","hireDate","name","hireDate","type","date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","status"],["id","status","name","status","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","Active"],["value","Inactive"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"alert","alert-danger","mx-3","mt-3"],[3,"value"],[1,"alert","alert-danger"],[4,"ngIf"],[1,"invalid-feedback"]],template:function(n,e){if(n&1){let r=A();i(0,"div",6)(1,"div",7)(2,"h2"),d(3,"Add Employee"),t()(),s(4,ie,2,1,"div",8),i(5,"form",9,0),E("ngSubmit",function(){return f(r),g(e.onSubmit())}),i(7,"div",10)(8,"div",11)(9,"label",12),d(10,"Email"),t(),i(11,"select",13,1),S("ngModelChange",function(o){return f(r),h(e.employee.email,o)||(e.employee.email=o),g(o)}),i(13,"option",14),d(14,"Select an email"),t(),s(15,oe,2,2,"option",15),t(),s(16,re,2,1,"div",16),t(),i(17,"div",11)(18,"label",17),d(19,"Position *"),t(),i(20,"input",18,2),S("ngModelChange",function(o){return f(r),h(e.employee.position,o)||(e.employee.position=o),g(o)}),t(),s(22,ae,2,0,"div",19),t()(),i(23,"div",10)(24,"div",11)(25,"label",20),d(26,"Department *"),t(),i(27,"select",21,3),S("ngModelChange",function(o){return f(r),h(e.employee.department,o)||(e.employee.department=o),g(o)}),i(29,"option",14),d(30,"Select department"),t(),s(31,le,2,2,"option",15),t(),s(32,de,2,0,"div",19),t(),i(33,"div",11)(34,"label",22),d(35,"Hire Date *"),t(),i(36,"input",23,4),S("ngModelChange",function(o){return f(r),h(e.employee.hire_date,o)||(e.employee.hire_date=o),g(o)}),t(),s(38,me,2,0,"div",19),t()(),i(39,"div",10)(40,"div",11)(41,"label",24),d(42,"Status *"),t(),i(43,"select",25,5),S("ngModelChange",function(o){return f(r),h(e.employee.status,o)||(e.employee.status=o),g(o)}),i(45,"option",14),d(46,"Select status"),t(),i(47,"option",26),d(48,"Active"),t(),i(49,"option",27),d(50,"Inactive"),t()(),s(51,ce,2,0,"div",19),t()(),i(52,"div",28)(53,"button",29),E("click",function(){return f(r),g(e.cancel())}),d(54,"Cancel"),t(),i(55,"button",30),d(56,"Add Employee"),t()()()()}if(n&2){let r=v(12),c=v(21),o=v(28),y=v(37),b=v(44);m(4),p("ngIf",e.error),m(7),_("ngModel",e.employee.email),m(4),p("ngForOf",e.activeAccountEmails),m(),p("ngIf",r.invalid&&(r.dirty||r.touched||e.formSubmitted)),m(4),C("is-invalid",c.invalid&&c.touched||e.formSubmitted&&c.invalid),_("ngModel",e.employee.position),m(2),p("ngIf",c.invalid&&c.touched||e.formSubmitted&&c.invalid),m(5),C("is-invalid",o.invalid&&o.touched||e.formSubmitted&&o.invalid),_("ngModel",e.employee.department),m(4),p("ngForOf",e.departments),m(),p("ngIf",o.invalid&&o.touched||e.formSubmitted&&o.invalid),m(4),C("is-invalid",y.invalid&&y.touched||e.formSubmitted&&y.invalid),_("ngModel",e.employee.hire_date),m(2),p("ngIf",y.invalid&&y.touched||e.formSubmitted&&y.invalid),m(5),C("is-invalid",b.invalid&&b.touched||e.formSubmitted&&b.invalid),_("ngModel",e.employee.status),m(8),p("ngIf",b.invalid&&b.touched||e.formSubmitted&&b.invalid)}},dependencies:[q,T,V,J,L,U,H,N,Q,z,R,G,B,j],styles:[`.employee-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem}.employee-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .employee-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px}.employee-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;text-align:left}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:8px 10px;font-size:1rem;border:1px solid #ced4da;border-radius:4px;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:#80bdff;box-shadow:0 0 5px #007bff80}.card[_ngcontent-%COMP%]{max-width:800px;margin:20px auto;background-color:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Arial,sans-serif}.card-header[_ngcontent-%COMP%]{padding:1rem 1.5rem;background-color:#f8f9fa;border-bottom:1px solid #dee2e6;border-radius:8px 8px 0 0}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333;font-size:1.5rem;font-weight:600}.form[_ngcontent-%COMP%]{padding:20px 30px}.form-row[_ngcontent-%COMP%]{display:flex;gap:1.5rem;margin-bottom:1.5rem;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:200px}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:#333;font-size:1rem}.form-control[_ngcontent-%COMP%]{width:100%;padding:.375rem .75rem;font-size:1rem;line-height:1.5;color:#495057;background-color:#fff;border:1px solid #ced4da;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 8px #007bff40}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%23dc3545' viewBox='0 0 12 12'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .75rem center;background-size:1em 1em;padding-right:2.5rem}.invalid-feedback[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:#dc3545;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem;padding-top:1rem;border-top:1px solid #dee2e6}.btn[_ngcontent-%COMP%]{display:inline-block;font-weight:500;text-align:center;-webkit-user-select:none;user-select:none;padding:.375rem 1rem;font-size:1rem;line-height:1.5;border-radius:.25rem;cursor:pointer;border:1px solid transparent;transition:background-color .15s ease-in-out,border-color .15s ease-in-out}.btn-primary[_ngcontent-%COMP%]{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0069d9;border-color:#0062cc}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#a6c8ff;border-color:#a6c8ff;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268;border-color:#545b62}.alert[_ngcontent-%COMP%]{padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem;font-size:1rem}.alert-danger[_ngcontent-%COMP%]{color:#721c24;background-color:#f8d7da;border-color:#f5c6cb}.loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#6c757d}`]})};export{ee as AddEmployeeComponent};
