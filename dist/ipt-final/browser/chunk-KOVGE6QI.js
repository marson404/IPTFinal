import{a as Y}from"./chunk-Q3S7IUFL.js";import{a as W}from"./chunk-INEJZO7B.js";import{a as z}from"./chunk-JJSI5YBX.js";import{b as V,e as F,h as N,i as R,j as $,o as j}from"./chunk-SWDTLJ4O.js";import{a as A}from"./chunk-6ET2QAO6.js";import{A as b,B as M,F as u,I as c,K as n,L as o,M as p,N as w,O as _,P as m,U as r,V as y,W as O,X as v,Y as P,Z as S,_ as k,a as C,b as E,ka as I,la as T,na as D,s as f,t as g,ta as q,y as l}from"./chunk-RY5F4FTU.js";function U(a,e){if(a&1&&(n(0,"div",11),r(1),o()),a&2){let t=m();l(),O(" ",t.error," ")}}function H(a,e){a&1&&(n(0,"div",12),p(1,"i",13),r(2," Loading... "),o())}function J(a,e){a&1&&(n(0,"span",27),r(1,"Active"),o())}function K(a,e){a&1&&(n(0,"span",28),r(1,"Inactive"),o())}function Q(a,e){if(a&1){let t=w();n(0,"tr")(1,"td"),r(2),o(),n(3,"td"),r(4),o(),n(5,"td"),r(6),o(),n(7,"td"),r(8),o(),n(9,"td"),u(10,J,2,0,"span",16)(11,K,2,0,"span",17),o(),n(12,"td")(13,"div",18)(14,"button",19),_("click",function(){let i=f(t).$implicit,d=m(2);return g(d.editEmployee(i.id))}),p(15,"i",20),r(16," Edit "),o(),n(17,"button",21),_("click",function(){let i=f(t).$implicit,d=m(2);return g(d.viewRequests(i))}),p(18,"i",22),r(19," Requests "),o(),n(20,"button",23),_("click",function(){let i=f(t).$implicit,d=m(2);return g(d.viewWorkflow(i))}),p(21,"i",24),r(22," Workflow "),o(),n(23,"button",25),_("click",function(){let i=f(t).$implicit,d=m(2);return g(d.openTransferModal(i))}),p(24,"i",26),r(25," Transfer "),o()()()()}if(a&2){let t=e.$implicit;l(2),v("",t.first_name," ",t.last_name,""),l(2),y(t.email),l(2),y(t.position),l(2),y(t.department),l(2),c("ngIf",t.status==="Active"),l(),c("ngIf",t.status!=="Active")}}function X(a,e){if(a&1&&(n(0,"table",14)(1,"thead")(2,"tr")(3,"th"),r(4,"Name"),o(),n(5,"th"),r(6,"Email"),o(),n(7,"th"),r(8,"Position"),o(),n(9,"th"),r(10,"Department"),o(),n(11,"th"),r(12,"Status"),o(),n(13,"th"),r(14,"Actions"),o()()(),n(15,"tbody"),u(16,Q,26,7,"tr",15),o()()),a&2){let t=m();l(16),c("ngForOf",t.employees)}}function Z(a,e){a&1&&(n(0,"div",29),r(1," No employees found. "),o())}function ee(a,e){if(a&1&&(n(0,"option",41),r(1),o()),a&2){let t=e.$implicit;c("value",t),l(),y(t)}}function te(a,e){if(a&1){let t=w();n(0,"div",30)(1,"div",31)(2,"div",32)(3,"div",1)(4,"h3"),r(5,"Transfer Employee"),o()(),n(6,"div",4)(7,"p",33),r(8," Transfer "),n(9,"strong"),r(10),o(),p(11,"br"),r(12," from "),n(13,"span",34),r(14),o(),r(15," to: "),o(),n(16,"div",35)(17,"select",36),k("ngModelChange",function(i){f(t);let d=m();return S(d.newDepartment,i)||(d.newDepartment=i),g(i)}),n(18,"option",37),r(19,"Select Department"),o(),u(20,ee,2,2,"option",38),o()()(),n(21,"div",7)(22,"button",21),_("click",function(){f(t);let i=m();return g(i.closeTransferModal())}),p(23,"i",39),r(24," Cancel "),o(),n(25,"button",40),_("click",function(){f(t);let i=m();return g(i.transferEmployee())}),p(26,"i",26),r(27," Transfer "),o()()()()()}if(a&2){let t=m();l(10),v("",t.selectedEmployee==null?null:t.selectedEmployee.first_name," ",t.selectedEmployee==null?null:t.selectedEmployee.last_name,""),l(4),y(t.selectedEmployee==null?null:t.selectedEmployee.department),l(3),P("ngModel",t.newDepartment),l(3),c("ngForOf",t.departments),l(5),c("disabled",!t.newDepartment)}}var L=class a{constructor(e,t,s,i,d){this.router=e;this.employeeService=t;this.requestService=s;this.departmentService=i;this.workflowService=d}employees=[];loading=!1;error="";showTransferModal=!1;selectedEmployee=null;newDepartment="";departments=[];ngOnInit(){this.loadEmployees(),this.loadDepartments()}loadEmployees(){this.loading=!0,this.error="",this.employeeService.getAllEmployees().subscribe({next:e=>{console.log("Loaded employees:",e),this.employees=e,this.loading=!1},error:e=>{console.error("Error loading employees:",e),this.error=e,this.loading=!1}})}loadDepartments(){this.departmentService.getDepartmentNames().subscribe({next:e=>{console.log("Loaded departments:",e),this.departments=e},error:e=>{console.error("Error loading departments:",e),this.error="Error loading departments: "+e}})}addEmployee(){this.router.navigate(["/employees/add"])}editEmployee(e){this.router.navigate(["/employees/edit",e])}deleteEmployee(e){confirm("Are you sure you want to delete this employee?")&&this.employeeService.deleteEmployee(e).subscribe({next:()=>{console.log("Employee deleted successfully"),this.employees=this.employees.filter(t=>t.id!==e)},error:t=>{console.error("Error deleting employee:",t),this.error="Failed to delete employee: "+t}})}requestAction(e){this.router.navigate(["/requests/add"],{state:{employeeId:e.id,employeeEmail:e.email}})}workflowAction(e){this.router.navigate(["/workflow"],{state:{employeeId:e}})}openTransferModal(e){this.selectedEmployee=e,this.newDepartment=e.department||"",this.showTransferModal=!0}closeTransferModal(){this.showTransferModal=!1,this.selectedEmployee=null,this.newDepartment=""}transferEmployee(){!this.selectedEmployee||!this.newDepartment||this.departmentService.getAll().subscribe({next:e=>{let t=e.find(i=>i.name===this.newDepartment);if(!t){this.error="Department not found";return}let s=E(C({},this.selectedEmployee),{department_id:t.id});this.employeeService.updateEmployee(this.selectedEmployee.id,s).subscribe({next:i=>{console.log("Employee transferred successfully:",i);let d=this.employees.findIndex(x=>x.id===i.id);d!==-1&&(this.employees[d]=i);let B={type:"Department Transfer",employeeId:i.id,employeeEmail:i.email,items:`Department transfer from ${this.selectedEmployee?.department} to ${this.newDepartment}`,status:"Pending"};this.requestService.createRequest(B).subscribe({next:x=>{let G={request_id:x.id,employee_id:i.id,current_step:`Transfer from ${this.selectedEmployee?.department} to ${this.newDepartment}`,status:"Pending",request_type:"Department Transfer",request_items:`Department transfer from ${this.selectedEmployee?.department} to ${this.newDepartment}`};this.workflowService.createWorkflow(G).subscribe({next:h=>{console.log("Workflow created successfully:",h),this.closeTransferModal()},error:h=>{console.error("Error creating workflow:",h),this.error="Failed to create workflow: "+h}})},error:x=>{console.error("Error creating request:",x),this.error="Failed to create request: "+x}})},error:i=>{console.error("Error transferring employee:",i),this.error="Failed to transfer employee: "+i}})},error:e=>{console.error("Error getting departments:",e),this.error="Failed to get departments: "+e}})}viewWorkflow(e){this.router.navigate(["/workflow"],{state:{employeeId:e.id,employeeName:`${e.first_name} ${e.last_name}`}})}viewRequests(e){this.router.navigate(["/requests"],{state:{employeeId:e.id,employeeEmail:e.email}})}static \u0275fac=function(t){return new(t||a)(b(q),b(W),b(z),b(A),b(Y))};static \u0275cmp=M({type:a,selectors:[["app-employees"]],decls:14,vars:5,consts:[[1,"card"],[1,"card-header"],["class","alert alert-danger",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"card-body"],["class","data-table",4,"ngIf"],["class","no-records",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],["class","modal-overlay",4,"ngIf"],[1,"alert","alert-danger"],[1,"loading-spinner"],[1,"icon","fas","fa-spinner","fa-spin"],[1,"data-table"],[4,"ngFor","ngForOf"],["class","badge badge-success",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],[1,"action-buttons"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-clipboard-list"],[1,"btn","btn-info",3,"click"],[1,"fas","fa-project-diagram"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-exchange-alt"],[1,"badge","badge-success"],[1,"badge","badge-danger"],[1,"no-records"],[1,"modal-overlay"],[1,"modal"],[1,"modal-content"],[1,"employee-info"],[1,"badge","badge-primary"],[1,"form-group"],[1,"form-control",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"fas","fa-times"],[1,"btn","btn-primary",3,"click","disabled"],[3,"value"]],template:function(t,s){t&1&&(n(0,"div",0)(1,"div",1)(2,"h2"),r(3,"Employees Management"),o()(),u(4,U,2,1,"div",2)(5,H,3,0,"div",3),n(6,"div",4),u(7,X,17,1,"table",5)(8,Z,2,0,"div",6),o(),n(9,"div",7)(10,"button",8),_("click",function(){return s.addEmployee()}),p(11,"i",9),r(12," Add Employee "),o()()(),u(13,te,28,6,"div",10)),t&2&&(l(4),c("ngIf",s.error),l(),c("ngIf",s.loading),l(2),c("ngIf",!s.loading&&s.employees.length>0),l(),c("ngIf",!s.loading&&s.employees.length===0),l(5),c("ngIf",s.showTransferModal))},dependencies:[D,I,T,j,R,$,N,V,F],styles:[".card[_ngcontent-%COMP%]{max-width:1200px;margin-top:25px;margin:2rem auto;padding:1.5rem 2rem;background:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a;display:flex;flex-direction:column;gap:1rem}.card-header[_ngcontent-%COMP%]{border-radius:8px 8px 0 0}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1rem;font-weight:400;color:#222;font-size:1.75rem;border-bottom:1.5px solid #ccc;padding-bottom:.5rem}.card-footer[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:1px solid #e0e0e0;display:flex;justify-content:flex-end}.card-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#28a745;border:none;color:#fff;padding:10px 20px;border-radius:6px;font-weight:600;font-size:.95rem;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px #0000001a}.card-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#19692c;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:1rem;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333;margin-top:0;min-width:1000px}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#f3f4f6}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:12px 15px;text-align:left}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1;transition:background-color .2s ease}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px;flex-direction:row;align-items:center;white-space:nowrap;flex-wrap:nowrap;justify-content:flex-start;min-width:max-content}.card-body[_ngcontent-%COMP%]{overflow-x:auto;width:100%}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:6px;cursor:pointer;font-weight:500;font-size:.85rem;transition:all .2s ease;box-shadow:0 2px 4px #0000001a;min-width:fit-content;white-space:nowrap;margin:0}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{background-color:#138496;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn-workflow[_ngcontent-%COMP%]{background-color:#6f42c1;color:#fff}.btn-workflow[_ngcontent-%COMP%]:hover{background-color:#553098;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn-request[_ngcontent-%COMP%]{background-color:#fd7e14;color:#fff}.btn-request[_ngcontent-%COMP%]:hover{background-color:#dc6a11;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.status-active[_ngcontent-%COMP%]{color:#28a745;font-weight:500}.status-inactive[_ngcontent-%COMP%]{color:#dc3545;font-weight:500}.loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;font-size:1.1rem}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;margin-bottom:1rem}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;border:1px solid #f5c6cb;color:#721c24}.no-records[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;font-style:italic}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;width:90%;max-width:500px;box-shadow:0 4px 12px #00000026}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:#333}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem;color:#666}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:4px;margin-bottom:1rem;font-size:1rem}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:1.5rem}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px;vertical-align:middle}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{min-width:max-content;width:1%;white-space:nowrap}",".data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin:1rem 0}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border:1px solid #dee2e6}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:500}.badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:4px;font-weight:400}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:4px;margin-right:.5rem}.btn[_ngcontent-%COMP%]:last-child{margin-right:0}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:90%;max-width:500px;box-shadow:0 4px 12px #00000026}"]})};export{L as EmployeesComponent};
